```xml
<plugin>
    <groupId>org.jetbrains.kotlin</groupId>
    <artifactId>kotlin-maven-plugin</artifactId>
    <version>${kotlin.version}</version>
    <executions>
        <execution>
            <id>compile</id>
            <phase>compile</phase>
            <goals>
                <goal>compile</goal>
            </goals>
        </execution>
        <execution>
            <id>test-compile</id>
            <phase>test-compile</phase>
            <goals>
                <goal>test-compile</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <jvmTarget>17</jvmTarget>
    </configuration>
</plugin>
```

Fix migration mistakes

- Use `data` classes for java `record`

```kotlin
class Error 
class Money
```

```kotlin
data class Money(val amount: Double, val currency: Currency) {
```

Use proper types everywhere -> avoid ? 


Exemple 

```kotlin
   private fun toFailure(convertedMoneys: List<Either<Error?, Money?>?>): Error {
        return Error(convertedMoneys
            .filter { obj: Either<Error?, Money?>? -> obj!!.isLeft }
            .map { e: Either<Error?, Money?>? -> String.format("[%s]", e!!.left.message()) }
            .mkString("Missing exchange rate(s): ", ",", ""))
    }
```


Fix java interop problems:
```java
public class AddExchangeRateUseCase implements UseCase<AddExchangeRateCommand, Unit> {
    private final BankRepository bankRepository;

    public AddExchangeRateUseCase(BankRepository bankRepository) {
        this.bankRepository = bankRepository;
    }

    @Override
    public Either<UseCaseError, Unit> invoke(AddExchangeRateCommand addExchangeRate) {
        return from(addExchangeRate.rate(), addExchangeRate.currency())
                .flatMap(this::addExchangeRate)
                .map(bank -> unit())
                .mapLeft(domainError -> error(domainError.message()));
    }

    private Either<Error, Bank> addExchangeRate(ExchangeRate rate) {
        return bankRepository.getBank()
                .toEither(new Error("No bank defined"))
                .flatMap(bank -> bank.add(rate))
                .peek(bankRepository::save);
    }
}

```

Compiler as a driver